<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">

<div class="container my-5" *ngIf="property">
    <div class="row g-4">
        <!-- صورة العقار الرئيسية -->
        <div class="col-12">
            <div class="hero-image position-relative overflow-hidden rounded shadow-sm">

                <!-- حاوية بنسبة 16:9 (يمكن تغييرها لـ 4x3 أو 21x9 حسب رغبتك) -->
                <div class="ratio ratio-16x9">
                    <img [src]="property.mainImage" alt="Main Image" class="w-100 h-100 object-fit-cover"
                        style="object-position: center;">
                </div>

                <!--.overlay stays the same -->
                <div class="overlay position-absolute bottom-0 start-0 w-100 p-4 bg-dark bg-opacity-50 text-white">
                    <div class="d-flex justify-content-between align-items-end">
                        <div>
                            <h2 class="text-white fw-bold mb-2">{{ property.title }}</h2>
                            <span class="badge bg-primary px-3 py-2 fs-6">{{ property.categoryName }}</span>
                        </div>
                        <div class="price-tag bg-white text-primary px-4 py-2 rounded-pill fw-bold fs-5">
                            {{ property.price | number }} $
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="card shadow-sm h-100">
                <div class="card-body property-details">
                    <!-- العنوان ورقم العقار -->
                    <div class="mb-4">
                        <h2 class="fw-bold mb-3">{{ property.title }}</h2>
                        <div class="d-flex align-items-center text-muted fs-5">
                            <i class="bi bi-hash me-2"></i>
                            <span>رقم العقار: {{ property.propertyNumber }}</span>
                        </div>
                    </div>

                    <!-- تفاصيل العقار -->
                    <div class="row g-4 mb-4">
                        <!-- المساحة -->
                        <div class="col-sm-6">
                            <div class="detail-item d-flex align-items-center p-3 bg-light rounded-3 h-100">
                                <i class="bi bi-rulers fs-6 text-primary mx-3"></i>
                                <div>
                                    <h5 class="fw-bold mb-1">المساحة</h5>
                                    <p class="mb-0 fs-5">{{ property.area }} م²</p>
                                </div>
                            </div>
                        </div>

                        <!-- الحالة -->
                        <div class="col-sm-6">
                            <div class="detail-item d-flex align-items-center p-3 bg-light rounded-3 h-100">
                                <i class="bi bi-check-circle-fill fs-6 text-success mx-3"></i>
                                <div>
                                    <h5 class="fw-bold mb-1">الحالة</h5>
                                    <p class="mb-0 fs-5">
                                        {{ (property.propertyStatus | propertyStatusAr).text }}</p>
                                </div>
                            </div>
                        </div>

                        <!-- التقييم -->
                        <div class="col-sm-6">
                            <div class="detail-item d-flex align-items-center p-3 bg-light rounded-3 h-100">
                                <i class="bi bi-star-fill fs-6 text-warning mx-3"></i>
                                <div>
                                    <h5 class="fw-bold mb-1">التقييم</h5>
                                    <p class="mb-0 fs-5">

                                        <app-star [rating]="property.rating"></app-star>
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- الموقع -->
                        <div class="col-sm-6">
                            <div class="detail-item d-flex align-items-center p-3 bg-light rounded-3 h-100">
                                <i class="bi bi-geo-alt-fill fs-6 text-danger mx-3"></i>
                                <div>
                                    <h5 class="fw-bold mb-1">الموقع</h5>
                                    <p class="mb-0 fs-5">{{ property.location }}</p>
                                </div>
                            </div>
                        </div>

                        <!-- العنوان التفصيلي -->
                        <div class="col-12">
                            <div class="detail-item d-flex align-items-center p-3 bg-light rounded-3">
                                <i class="bi bi-house-door-fill fs-6 text-info mx-3"></i>
                                <div>
                                    <h5 class="fw-bold mb-1">العنوان التفصيلي</h5>
                                    <p class="mb-0 fs-5">{{ property.address }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- الوصف -->
                    <div class="description-section mt-5">
                        <h4 class="fw-bold mb-3 border-bottom pb-2">الوصف</h4>
                        <p class="fs-5 lh-lg">{{ property.description }}</p>
                    </div>
                </div>

            </div>
        </div>

        <div class="col-lg-4">
            <div class="card shadow-sm h-100 owner-box">
                <div class="card-body">
                    <h5 class="card-title mb-4 section-title">بيانات المالك</h5>
                    <div class="owner-info-section">

                        <div class="d-flex align-items-center mb-2 p-3 bg-light rounded-3">
                            <div class="icon-wrapper bg-primary bg-opacity-10 d-flex justify-content-center align-items-center rounded-circle flex-shrink-0"
                                style="width: 55px; height: 55px;">
                                <i class="bi bi-person-fill fs-8 text-primary"></i>
                            </div>
                            <div class="me-3">
                                <h5 class="fw-bold mb-1 text-dark">المالك</h5>
                                <p class="mb-0 fs-5">{{ property.ownerFullName }}</p>
                            </div>
                        </div>

                        <div class="d-flex align-items-center p-3 bg-light rounded-3 ">
                            <div class="icon-wrapper bg-primary bg-opacity-10 d-flex justify-content-center align-items-center rounded-circle flex-shrink-0"
                                style="width: 55px; height: 55px;">
                                <i class="bi bi-credit-card-2-front-fill fs-6 text-primary"></i>
                            </div>
                            <div class="me-3">
                                <h5 class="fw-bold mb-1 text-dark">رقم الهوية</h5>
                                <p class="mb-0 fs-5">{{ property.ownerNationalId }}</p>
                            </div>
                        </div>
                    </div>


                    <div class="mt-4 pt-3 border-top">
                        <button class="btn btn-primary w-100 py-2">
                            <i class="bi bi-whatsapp me-2"></i> التواصل عبر واتساب
                        </button>
                        <button class="btn btn-outline-primary w-100 mt-2 py-2">
                            <i class="bi bi-telephone me-2"></i> الاتصال بالمالك
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- فيديو العقار -->
        <div class="col-12" *ngIf="property.videoUrl">
            <div class="card shadow-sm border-0 overflow-hidden">
                <div class="card-body">
                    <h5 class="section-title mb-4">فيديو العقار</h5>

                    <!-- حاوية بنسبة 16:9 لضبط الحجم -->
                    <div class="ratio ratio-16x9 rounded overflow-hidden">
                        <video [src]="property.videoUrl" class="w-100 h-100 object-fit-contain"
                            poster="{{property.mainImage}}" controls>
                            المتصفح لا يدعم تشغيل الفيديو
                        </video>
                    </div>
                </div>
            </div>
        </div>

        <!-- الصور الإضافية -->
        <div class="col-12">
            <div class="card shadow-sm border-0">
                <div class="card-body">
                    <h5 class="section-title">معرض الصور</h5>
                    <div class="row g-3">
                        <div class="col-6 col-md-4 col-lg-3" *ngFor="let img of property.images; let i = index">
                            <div class="position-relative">
                                <img [src]="img" class="img-fluid rounded shadow-sm w-100 property-thumbnail"
                                    alt="Property Image {{i+1}}" />
                                <div
                                    class="position-absolute top-0 end-0 m-2 bg-dark bg-opacity-50 text-white rounded-circle p-2 px-3">
                                    {{i+1}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- خريطة الموقع -->
        <div class="col-12">
            <div class="card shadow-sm border-0">
                <div class="card-body">
                    <h5 class="section-title">الموقع على الخريطة</h5>
                    <div class="ratio ratio-16x9 rounded overflow-hidden">
                        <!-- هنا يمكن إضافة خريطة جوجل أو أي خدمة خرائط أخرى -->
                        <div class="bg-light d-flex align-items-center justify-content-center">
                            <i class="bi bi-map fs-1 text-muted"></i>
                            <span class="ms-2 fs-5">خريطة الموقع</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>